import{a2 as E,r as c,j as s,a5 as T,B as d,l as $,m as x,S as L}from"./index-BxPqZtyK.js";import{D as R}from"./download-D9AsqJ4u.js";import{T as b}from"./trash-2-fswwwBiO.js";import{R as z}from"./refresh-cw-CDwP-Kjv.js";const I=()=>{const{preferences:l,updatePreferences:h,clearAllConsents:O}=E(),[a,p]=c.useState([]),[m,j]=c.useState([]),[u,v]=c.useState(!1);c.useEffect(()=>{const t=()=>{const n=document.cookie.split(";"),r=[];n.forEach(i=>{const[o,g]=i.trim().split("=");if(o&&g){const D=N(o);r.push({name:o.trim(),value:g.trim(),domain:window.location.hostname,path:"/",secure:window.location.protocol==="https:",httpOnly:!1,sameSite:"Lax",category:D,purpose:y(o),retention:C(o)})}}),p(r)};t();const e=setInterval(t,3e4);return()=>clearInterval(e)},[]),c.useEffect(()=>{const t=[{type:"essential",name:"Cookies Esenciales",description:"Necesarias para el funcionamiento del sitio",enabled:l.essential,cookies:a.filter(e=>e.category==="essential")},{type:"functional",name:"Cookies Funcionales",description:"Mejoran la funcionalidad y personalización",enabled:l.functional,cookies:a.filter(e=>e.category==="functional")},{type:"analytics",name:"Cookies de Análisis",description:"Ayudan a entender el uso del sitio",enabled:l.analytics,cookies:a.filter(e=>e.category==="analytics")},{type:"marketing",name:"Cookies de Marketing",description:"Publicidad y marketing personalizado",enabled:l.marketing,cookies:a.filter(e=>e.category==="marketing")},{type:"social_media",name:"Cookies de Redes Sociales",description:"Integración con redes sociales",enabled:l.social_media,cookies:a.filter(e=>e.category==="social_media")}];j(t)},[a,l]);const N=t=>{const e=t.toLowerCase();return e.includes("session")||e.includes("csrf")||e.includes("auth")||e.includes("wildtour-token")||e.includes("security")?"essential":e.includes("_ga")||e.includes("_gid")||e.includes("analytics")||e.includes("_gtm")||e.includes("hotjar")?"analytics":e.includes("_fbp")||e.includes("_fbc")||e.includes("ads")||e.includes("marketing")||e.includes("pixel")?"marketing":e.includes("facebook")||e.includes("twitter")||e.includes("instagram")||e.includes("social")||e.includes("share")?"social_media":"functional"},y=t=>{const e=t.toLowerCase();return e.includes("session")?"Gestión de sesión de usuario":e.includes("auth")?"Autenticación y seguridad":e.includes("_ga")?"Google Analytics - Análisis de tráfico":e.includes("_fbp")?"Facebook Pixel - Seguimiento publicitario":e.includes("consent")?"Preferencias de consentimiento":e.includes("theme")?"Preferencias de tema visual":e.includes("lang")?"Preferencias de idioma":"Funcionalidad del sitio web"},C=t=>{const e=t.toLowerCase();return e.includes("session")?"Sesión":e.includes("_ga")?"2 años":e.includes("_gid")?"24 horas":e.includes("consent")?"12 meses":e.includes("auth")?"30 días":"1 año"},w=t=>{t!=="essential"&&h({[t]:!l[t]})},f=t=>{document.cookie=`${t}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`,document.cookie=`${t}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; domain=${window.location.hostname};`,document.cookie=`${t}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; domain=.${window.location.hostname};`,p(e=>e.filter(n=>n.name!==t))},k=t=>{if(t==="essential")return;a.filter(n=>n.category===t).forEach(n=>{f(n.name)}),h({[t]:!1})},S=()=>{const t={timestamp:new Date().toISOString(),preferences:l,detectedCookies:a.map(i=>({name:i.name,category:i.category,purpose:i.purpose,retention:i.retention,domain:i.domain})),categories:m.map(i=>({type:i.type,name:i.name,enabled:i.enabled,cookieCount:i.cookies.length}))},e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=`wildtour-cookies-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)},_=(t,e)=>{if(!e)return"bg-neutral-100 text-neutral-500";switch(t){case"essential":return"bg-green-100 text-green-700";case"functional":return"bg-blue-100 text-blue-700";case"analytics":return"bg-purple-100 text-purple-700";case"marketing":return"bg-orange-100 text-orange-700";case"social_media":return"bg-pink-100 text-pink-700";default:return"bg-neutral-100 text-neutral-500"}};return s.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-neutral-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-amber-500 to-orange-500 rounded-xl flex items-center justify-center mr-3",children:s.jsx(T,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-display font-bold text-neutral-800",children:"Gestor de Cookies"}),s.jsx("p",{className:"text-neutral-600 text-sm",children:"Control granular de cookies por categorías"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(d,{onClick:()=>v(!u),variant:"outline",size:"sm",children:[s.jsx($,{className:"w-4 h-4 mr-2"}),u?"Ocultar":"Detalles"]}),s.jsxs(d,{onClick:S,variant:"outline",size:"sm",children:[s.jsx(R,{className:"w-4 h-4 mr-2"}),"Exportar"]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[s.jsxs("div",{className:"bg-neutral-50 rounded-xl p-4 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-neutral-800",children:a.length}),s.jsx("div",{className:"text-sm text-neutral-600",children:"Total Cookies"})]}),s.jsxs("div",{className:"bg-green-50 rounded-xl p-4 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-green-700",children:m.filter(t=>t.enabled).length}),s.jsx("div",{className:"text-sm text-green-600",children:"Categorías Activas"})]}),s.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-700",children:a.filter(t=>t.category==="essential").length}),s.jsx("div",{className:"text-sm text-blue-600",children:"Esenciales"})]}),s.jsxs("div",{className:"bg-amber-50 rounded-xl p-4 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-amber-700",children:a.filter(t=>t.category!=="essential").length}),s.jsx("div",{className:"text-sm text-amber-600",children:"Opcionales"})]})]}),s.jsx("div",{className:"space-y-4",children:m.map(t=>s.jsxs(x.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`border rounded-xl p-5 transition-all ${t.enabled?"border-primary-200 bg-primary-50":"border-neutral-200 bg-neutral-50"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-medium mr-3 ${_(t.type,t.enabled)}`,children:[t.cookies.length," cookies"]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-neutral-800",children:t.name}),s.jsx("p",{className:"text-sm text-neutral-600",children:t.description})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[t.type!=="essential"&&t.cookies.length>0&&s.jsxs(d,{onClick:()=>k(t.type),variant:"outline",size:"sm",className:"text-red-600 border-red-200 hover:bg-red-50",children:[s.jsx(b,{className:"w-4 h-4 mr-1"}),"Limpiar"]}),s.jsx("button",{onClick:()=>w(t.type),disabled:t.type==="essential",className:`w-12 h-6 rounded-full transition-colors relative ${t.enabled?"bg-primary-500":"bg-neutral-300"} ${t.type==="essential"?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:s.jsx(x.div,{animate:{x:t.enabled?24:2},transition:{type:"spring",stiffness:500,damping:30},className:"w-5 h-5 bg-white rounded-full absolute top-0.5 shadow-sm"})})]})]}),u&&t.cookies.length>0&&s.jsx(x.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"border-t border-neutral-200 pt-4 mt-4",children:s.jsx("div",{className:"space-y-3",children:t.cookies.map((e,n)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-neutral-100",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center mb-1",children:[s.jsx("span",{className:"font-medium text-neutral-800 mr-2",children:e.name}),e.secure&&s.jsx(L,{className:"w-3 h-3 text-green-500",title:"Segura"})]}),s.jsx("p",{className:"text-sm text-neutral-600 mb-1",children:e.purpose}),s.jsxs("div",{className:"flex gap-4 text-xs text-neutral-500",children:[s.jsxs("span",{children:["Dominio: ",e.domain]}),s.jsxs("span",{children:["Retención: ",e.retention]}),s.jsxs("span",{children:["SameSite: ",e.sameSite]})]})]}),t.type!=="essential"&&s.jsx(d,{onClick:()=>f(e.name),variant:"outline",size:"sm",className:"ml-4 text-red-600 border-red-200 hover:bg-red-50",children:s.jsx(b,{className:"w-3 h-3"})})]},`${e.name}-${n}`))})})]},t.type))}),s.jsx("div",{className:"mt-6 p-4 bg-neutral-50 rounded-xl",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center text-sm text-neutral-600",children:[s.jsx(z,{className:"w-4 h-4 mr-2"}),"Última actualización: ",new Date().toLocaleTimeString("es-ES")]}),s.jsx("div",{className:"text-xs text-neutral-500",children:"Cumplimiento Ley 1581/2012 - Colombia"})]})})]})};export{I as C};
