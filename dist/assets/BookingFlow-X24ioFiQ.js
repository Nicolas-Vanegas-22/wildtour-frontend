import{k as H,e as T,u as L,r as j,j as e}from"./index-BxPqZtyK.js";import{u as I}from"./useQuery-CGC4B3bg.js";import{a as S}from"./apiClient-BOD3YzUN.js";import"./index-NIGUFBhG.js";const b={async byId(i){const{data:c}=await S.get(`/destinations/${i}`);return c},async reviews(i){const{data:c}=await S.get(`/destinations/${i}/reviews`);return c},async search(i){const x=[{id:"1",name:"Hotel Boutique La Casona",location:"Villavieja",type:"hotel",price:12e4,image:"https://www.google.com/url?sa=i&url=https%3A%2F%2Fwww.tripadvisor.co%2FHotel_Review-g1507128-d23902569-Reviews-Hotel_Infinito_La_Casona-Villavieja_Huila_Department.html&psig=AOvVaw1W7d5YK-A5bxEPW-3XtXFP&ust=1757721218011000&source=images&cd=vfe&opi=89978449&ved=0CBUQjRxqFwoTCKiT9Pjz0Y8DFQAAAAAdAAAAABAE",description:"Hotel colonial en el centro histórico de Villavieja."},{id:"2",name:"Observatorio Astronómico y Hospedaje",location:"Desierto de la Tatacoa",type:"hostal",price:9e4,image:"/images/observatorio.jpg",description:"Hospedaje con experiencia de observación de estrellas."},{id:"3",name:"Hotel Villa del Sol",location:"Villavieja",type:"hotel",price:15e4,image:"/images/villadelsol.jpg",description:"Hotel con piscina y restaurante cerca al río Magdalena."},{id:"4",name:"Eco Hotel Noches de Saturno",location:"Desierto de la Tatacoa",type:"eco-hotel",price:11e4,image:"/images/nochesdesaturno.jpg",description:"Eco hotel en medio del desierto, ideal para desconexión y naturaleza."},{id:"3",name:"Hotel Villa del Sol",location:"Villavieja",type:"hotel",price:15e4,image:"/images/villadelsol.jpg",description:"Hotel con piscina y restaurante cerca al río Magdalena."},{id:"4",name:"Eco Hotel Noches de Saturno",location:"Desierto de la Tatacoa",type:"eco-hotel",price:11e4,image:"/images/nochesdesaturno.jpg",description:"Eco hotel en medio del desierto, ideal para desconexión y naturaleza."}].filter(o=>!(i.query&&!o.name.toLowerCase().includes(i.query.toLowerCase())||i.region&&o.location!==i.region||i.type&&o.type!==i.type||i.minPrice&&o.price<i.minPrice||i.maxPrice&&o.price>i.maxPrice));return{items:x,total:x.length}}};function B(){var N,w;const{id:i,type:c}=H(),x=T(),{user:o}=L(),[d,f]=j.useState(1),[a,l]=j.useState({serviceId:i||"",serviceType:c||"tours",checkIn:"",checkOut:"",guests:{adults:2,children:0},extras:[],totalPrice:0,customerInfo:{name:(o==null?void 0:o.name)||"",email:(o==null?void 0:o.email)||"",phone:"",specialRequests:""}}),h=[{id:1,title:"Fechas y Huéspedes",description:"Selecciona fechas y número de personas",completed:!1},{id:2,title:"Servicios Adicionales",description:"Elige extras y personalizaciones",completed:!1},{id:3,title:"Información Personal",description:"Completa tus datos de contacto",completed:!1},{id:4,title:"Confirmación",description:"Revisa y confirma tu reserva",completed:!1},{id:5,title:"Pago",description:"Completa el proceso de pago",completed:!1}],{data:r}=I({queryKey:["service",i,c],queryFn:()=>b.getServiceDetails(i,c)}),{data:y}=I({queryKey:["availability",i,a.checkIn,a.checkOut],queryFn:()=>b.checkAvailability(i,a.checkIn,a.checkOut),enabled:!!a.checkIn&&!!a.checkOut});j.useEffect(()=>{r&&a.checkIn&&a.checkOut&&C()},[r,a.checkIn,a.checkOut,a.guests,a.extras]);const C=()=>{if(!r)return;const s=r.price,t=c==="hospedaje"?u():1,n=a.guests.adults+a.guests.children*.5,m=a.extras.reduce((g,R)=>{var k;const p=(k=r.extras)==null?void 0:k.find(F=>F.id===R);return g+((p==null?void 0:p.price)||0)},0),O=s*t*n+m;l(g=>({...g,totalPrice:O}))},u=()=>{if(!a.checkIn||!a.checkOut)return 1;const s=new Date(a.checkIn),t=new Date(a.checkOut);return Math.ceil((t.getTime()-s.getTime())/(1e3*60*60*24))},P=()=>{v()&&f(s=>Math.min(s+1,h.length))},A=()=>{f(s=>Math.max(s-1,1))},v=()=>{switch(d){case 1:return a.checkIn&&a.checkOut&&a.guests.adults>0;case 2:return!0;case 3:return a.customerInfo.name&&a.customerInfo.email&&a.customerInfo.phone;case 4:return!0;default:return!1}},D=async()=>{try{const s=await b.createBooking(a);x(`/pago/${s.id}`)}catch{alert("Error al crear la reserva. Por favor intenta nuevamente.")}};return r?e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:["Reservar ",r.name]}),e.jsx("p",{className:"text-gray-600",children:r.location})]}),e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"flex justify-between items-center",children:h.map((s,t)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full border-2 ${d>=s.id?"bg-green-600 border-green-600 text-white":"border-gray-300 text-gray-400"}`,children:d>s.id?e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):s.id}),e.jsxs("div",{className:"ml-3 hidden md:block",children:[e.jsx("p",{className:`text-sm font-medium ${d>=s.id?"text-green-600":"text-gray-400"}`,children:s.title}),e.jsx("p",{className:"text-xs text-gray-500",children:s.description})]}),t<h.length-1&&e.jsx("div",{className:`flex-1 h-0.5 mx-4 ${d>s.id?"bg-green-600":"bg-gray-300"}`})]},s.id))})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[d===1&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Fechas y Huéspedes"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:c==="hospedaje"?"Fecha de entrada":"Fecha de inicio"}),e.jsx("input",{type:"date",value:a.checkIn,onChange:s=>l(t=>({...t,checkIn:s.target.value})),min:new Date().toISOString().split("T")[0],className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),c==="hospedaje"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha de salida"}),e.jsx("input",{type:"date",value:a.checkOut,onChange:s=>l(t=>({...t,checkOut:s.target.value})),min:a.checkIn||new Date().toISOString().split("T")[0],className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adultos"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>l(s=>({...s,guests:{...s.guests,adults:Math.max(1,s.guests.adults-1)}})),className:"w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50",children:"-"}),e.jsx("span",{className:"w-8 text-center",children:a.guests.adults}),e.jsx("button",{onClick:()=>l(s=>({...s,guests:{...s.guests,adults:s.guests.adults+1}})),className:"w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50",children:"+"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Niños"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>l(s=>({...s,guests:{...s.guests,children:Math.max(0,s.guests.children-1)}})),className:"w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50",children:"-"}),e.jsx("span",{className:"w-8 text-center",children:a.guests.children}),e.jsx("button",{onClick:()=>l(s=>({...s,guests:{...s.guests,children:s.guests.children+1}})),className:"w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50",children:"+"})]})]})]}),y===!1&&e.jsx("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-700",children:"No hay disponibilidad para las fechas seleccionadas. Por favor elige otras fechas."})})]}),d===2&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Servicios Adicionales"}),e.jsxs("div",{className:"space-y-4",children:[(N=r.extras)==null?void 0:N.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",id:s.id,checked:a.extras.includes(s.id),onChange:t=>{t.target.checked?l(n=>({...n,extras:[...n.extras,s.id]})):l(n=>({...n,extras:n.extras.filter(m=>m!==s.id)}))},className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:s.id,className:"font-medium text-gray-900 cursor-pointer",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.description})]})]}),e.jsxs("span",{className:"font-semibold text-green-600",children:["+$",s.price.toLocaleString()]})]},s.id)),(!r.extras||r.extras.length===0)&&e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No hay servicios adicionales disponibles para este servicio."})]})]}),d===3&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Información de Contacto"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre completo*"}),e.jsx("input",{type:"text",value:a.customerInfo.name,onChange:s=>l(t=>({...t,customerInfo:{...t.customerInfo,name:s.target.value}})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Tu nombre completo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email*"}),e.jsx("input",{type:"email",value:a.customerInfo.email,onChange:s=>l(t=>({...t,customerInfo:{...t.customerInfo,email:s.target.value}})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"tu@email.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Teléfono*"}),e.jsx("input",{type:"tel",value:a.customerInfo.phone,onChange:s=>l(t=>({...t,customerInfo:{...t.customerInfo,phone:s.target.value}})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"+57 300 123 4567"})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Solicitudes especiales"}),e.jsx("textarea",{value:a.customerInfo.specialRequests,onChange:s=>l(t=>({...t,customerInfo:{...t.customerInfo,specialRequests:s.target.value}})),rows:4,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"¿Tienes alguna solicitud especial? (dieta, accesibilidad, etc.)"})]})]}),d===4&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Confirma tu Reserva"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("img",{src:r.image,alt:r.name,className:"w-24 h-24 object-cover rounded-lg"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:r.name}),e.jsx("p",{className:"text-gray-600",children:r.location}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("span",{className:"text-yellow-500",children:"★"}),e.jsxs("span",{className:"ml-1 text-sm",children:[r.rating," (",r.reviewCount," opiniones)"]})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Detalles de la reserva"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Fechas:"}),e.jsxs("span",{children:[new Date(a.checkIn).toLocaleDateString()," - ",c==="hospedaje"?new Date(a.checkOut).toLocaleDateString():"Un día"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Huéspedes:"}),e.jsxs("span",{children:[a.guests.adults," adulto(s)",a.guests.children>0&&`, ${a.guests.children} niño(s)`]})]}),c==="hospedaje"&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Noches:"}),e.jsx("span",{children:u()})]})]})]}),a.extras.length>0&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Servicios adicionales"}),e.jsx("div",{className:"space-y-2 text-sm",children:a.extras.map(s=>{var n;const t=(n=r.extras)==null?void 0:n.find(m=>m.id===s);return t&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:t.name}),e.jsxs("span",{children:["$",t.price.toLocaleString()]})]},s)})})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Información de contacto"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("p",{children:a.customerInfo.name}),e.jsx("p",{children:a.customerInfo.email}),e.jsx("p",{children:a.customerInfo.phone}),a.customerInfo.specialRequests&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"font-medium",children:"Solicitudes especiales:"}),e.jsx("p",{className:"text-gray-600",children:a.customerInfo.specialRequests})]})]})]})]})]}),e.jsxs("div",{className:"flex justify-between mt-6",children:[e.jsx("button",{onClick:A,disabled:d===1,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Anterior"}),d<4?e.jsx("button",{onClick:P,disabled:!v()||d===1&&y===!1,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Siguiente"}):e.jsx("button",{onClick:D,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Proceder al Pago"})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 sticky top-8",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Resumen de Reserva"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Precio base:"}),e.jsxs("span",{children:["$",(w=r.price)==null?void 0:w.toLocaleString()]})]}),c==="hospedaje"&&a.checkIn&&a.checkOut&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:["× ",u()," noche(s):"]}),e.jsxs("span",{children:["$",(r.price*u()).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:["× ",a.guests.adults+a.guests.children*.5," persona(s):"]}),e.jsxs("span",{children:["$",((r.price||0)*(c==="hospedaje"?u():1)*(a.guests.adults+a.guests.children*.5)).toLocaleString()]})]}),a.extras.length>0&&e.jsxs("div",{className:"border-t pt-3",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"Extras:"}),a.extras.map(s=>{var n;const t=(n=r.extras)==null?void 0:n.find(m=>m.id===s);return t&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:[t.name,":"]}),e.jsxs("span",{children:["$",t.price.toLocaleString()]})]},s)})]}),e.jsx("div",{className:"border-t pt-3",children:e.jsxs("div",{className:"flex justify-between font-semibold",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{className:"text-green-600",children:["$",a.totalPrice.toLocaleString()]})]})})]}),e.jsxs("div",{className:"mt-6 p-4 bg-green-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"Política de cancelación"}),e.jsx("p",{className:"text-sm text-green-700",children:"Cancelación gratuita hasta 48 horas antes del inicio del servicio. Después se aplicará una penalidad del 50%."})]})]})})]})]}):e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})})}export{B as default};
