import{k as D,e as F,r as d,j as e}from"./index-BxPqZtyK.js";import{u as M}from"./useQuery-CGC4B3bg.js";import{B as $}from"./BookingRepo-DNL2fKhO.js";class R{static async processPayment(i,s,p){return console.warn("PaymentRepo.processPayment not implemented - using mock data"),new Promise(n=>{setTimeout(()=>{n({success:!0,transactionId:`txn-${Date.now()}`})},1e3)})}static async getPaymentMethods(i){return console.warn("PaymentRepo.getPaymentMethods not implemented - using mock data"),[]}static async addPaymentMethod(i,s){return console.warn("PaymentRepo.addPaymentMethod not implemented - using mock data"),{id:`pm-${Date.now()}`,...s}}}function E(){var v,f,y;const{bookingId:l}=D(),i=F(),[s,p]=d.useState(""),[n,c]=d.useState({number:"",expiry:"",cvv:"",holderName:"",documentType:"CC",documentNumber:""}),[u,N]=d.useState(""),[x,b]=d.useState(!1),[h,w]=d.useState(!1),{data:t}=M({queryKey:["booking",l],queryFn:()=>$.getById(l)}),m=[{id:"credit_card",name:"Tarjeta de Cr√©dito",type:"credit_card",icon:"üí≥",description:"Visa, Mastercard, American Express",processingFee:0},{id:"debit_card",name:"Tarjeta D√©bito",type:"debit_card",icon:"üí≥",description:"Tarjetas d√©bito nacionales e internacionales",processingFee:2e3},{id:"pse",name:"PSE",type:"pse",icon:"üè¶",description:"Pago seguro en l√≠nea con tu banco",processingFee:3500},{id:"nequi",name:"Nequi",type:"nequi",icon:"üì±",description:"Paga con tu cuenta Nequi",processingFee:1e3},{id:"daviplata",name:"DaviPlata",type:"daviplata",icon:"üì±",description:"Paga con tu cuenta DaviPlata",processingFee:1e3}],P=["Banco de Bogot√°","Bancolombia","Banco de Occidente","Banco Popular","BBVA Colombia","Banco Caja Social","Banco AV Villas","Bancoomeva","Banco Falabella","Banco Pichincha","Banco Cooperativo Coopcentral","Banco Mundo Mujer","Banco W","Banco Agrario","Banco GNB Sudameris"],g=()=>{if(!t)return 0;const a=m.find(o=>o.id===s),r=(a==null?void 0:a.processingFee)||0;return t.totalPrice+r},C=a=>a.replace(/\s/g,"").replace(/(.{4})/g,"$1 ").trim(),k=a=>a.replace(/\D/g,"").replace(/(\d{2})(\d)/,"$1/$2").substr(0,5),B=a=>{const r=a.target.value.replace(/\D/g,"");r.length<=16&&c(o=>({...o,number:C(r)}))},S=a=>{const r=a.target.value;c(o=>({...o,expiry:k(r)}))},j=()=>{if(!h)return!1;switch(s){case"credit_card":case"debit_card":return n.number.replace(/\s/g,"").length===16&&n.expiry.length===5&&n.cvv.length>=3&&n.holderName.trim()&&n.documentNumber.trim();case"pse":return u!=="";case"nequi":case"daviplata":return n.documentNumber.trim()!=="";default:return!1}},T=async()=>{if(!j()){alert("Por favor completa todos los campos requeridos");return}b(!0);try{const a={bookingId:l,method:s,amount:g(),...s==="credit_card"||s==="debit_card"?{cardDetails:{...n,number:n.number.replace(/\s/g,"")}}:{},...s==="pse"?{bank:u}:{},...s==="nequi"||s==="daviplata"?{phoneNumber:n.documentNumber}:{}},r=await R.processPayment(a);r.status==="approved"?i(`/reserva-confirmada/${l}`):r.status==="pending"?i(`/pago-pendiente/${l}`):alert("El pago fue rechazado. Por favor intenta con otro m√©todo de pago.")}catch(a){alert(a.message||"Error al procesar el pago. Por favor intenta nuevamente.")}finally{b(!1)}};return t?e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Pagar Reserva"}),e.jsx("p",{className:"text-gray-600",children:"Completa tu pago de forma segura"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"M√©todo de pago"}),e.jsx("div",{className:"space-y-3",children:m.map(a=>e.jsx("label",{className:"block",children:e.jsxs("div",{className:`flex items-center p-4 border-2 rounded-lg cursor-pointer transition-all ${s===a.id?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("input",{type:"radio",name:"paymentMethod",value:a.id,checked:s===a.id,onChange:r=>p(r.target.value),className:"sr-only"}),e.jsx("span",{className:"text-2xl mr-3",children:a.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:a.name}),e.jsx("div",{className:"text-sm text-gray-600",children:a.description}),a.processingFee&&a.processingFee>0&&e.jsxs("div",{className:"text-xs text-orange-600",children:["Tarifa de procesamiento: $",a.processingFee.toLocaleString()]})]}),e.jsx("div",{className:`w-4 h-4 rounded-full border-2 ${s===a.id?"border-green-500 bg-green-500":"border-gray-300"}`,children:s===a.id&&e.jsx("div",{className:"w-2 h-2 bg-white rounded-full mx-auto mt-0.5"})})]})},a.id))})]}),s&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Detalles de pago"}),(s==="credit_card"||s==="debit_card")&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"N√∫mero de tarjeta*"}),e.jsx("input",{type:"text",value:n.number,onChange:B,placeholder:"1234 5678 9012 3456",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha de vencimiento*"}),e.jsx("input",{type:"text",value:n.expiry,onChange:S,placeholder:"MM/AA",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CVV*"}),e.jsx("input",{type:"text",value:n.cvv,onChange:a=>{const r=a.target.value.replace(/\D/g,"");r.length<=4&&c(o=>({...o,cvv:r}))},placeholder:"123",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre del titular*"}),e.jsx("input",{type:"text",value:n.holderName,onChange:a=>c(r=>({...r,holderName:a.target.value})),placeholder:"Nombre como aparece en la tarjeta",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de documento*"}),e.jsxs("select",{value:n.documentType,onChange:a=>c(r=>({...r,documentType:a.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"CC",children:"C√©dula de ciudadan√≠a"}),e.jsx("option",{value:"CE",children:"C√©dula de extranjer√≠a"}),e.jsx("option",{value:"TI",children:"Tarjeta de identidad"}),e.jsx("option",{value:"PP",children:"Pasaporte"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"N√∫mero de documento*"}),e.jsx("input",{type:"text",value:n.documentNumber,onChange:a=>c(r=>({...r,documentNumber:a.target.value})),placeholder:"123456789",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500"})]})]})]}),s==="pse"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selecciona tu banco*"}),e.jsxs("select",{value:u,onChange:a=>N(a.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"",children:"Selecciona tu banco"}),P.map(a=>e.jsx("option",{value:a,children:a},a))]}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Ser√°s redirigido a tu banco para completar el pago de forma segura."})]}),(s==="nequi"||s==="daviplata")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"N√∫mero de celular*"}),e.jsx("input",{type:"tel",value:n.documentNumber,onChange:a=>c(r=>({...r,documentNumber:a.target.value})),placeholder:"3001234567",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Recibir√°s una notificaci√≥n push para aprobar el pago."})]})]}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:e.jsxs("label",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:a=>w(a.target.checked),className:"mt-1 rounded border-gray-300 text-green-600 focus:ring-green-500"}),e.jsx("div",{className:"text-sm",children:e.jsxs("span",{className:"text-gray-700",children:["Acepto los"," ",e.jsx("button",{className:"text-green-600 hover:text-green-700 underline",children:"t√©rminos y condiciones"})," ","y la"," ",e.jsx("button",{className:"text-green-600 hover:text-green-700 underline",children:"pol√≠tica de privacidad"}),". Tambi√©n acepto la pol√≠tica de cancelaci√≥n y reembolso."]})})]})}),e.jsx("button",{onClick:T,disabled:!j()||x,className:"w-full bg-green-600 text-white py-4 px-6 rounded-lg font-semibold hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:x?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Procesando pago..."]}):`Pagar ${g().toLocaleString()} COP`})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 sticky top-8",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Resumen del pedido"}),e.jsxs("div",{className:"flex gap-3 mb-4",children:[e.jsx("img",{src:t.service.image,alt:t.service.name,className:"w-16 h-16 object-cover rounded-lg"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:t.service.name}),e.jsx("p",{className:"text-sm text-gray-600",children:t.service.location})]})]}),e.jsxs("div",{className:"space-y-2 text-sm border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Fechas:"}),e.jsx("span",{children:new Date(t.checkIn).toLocaleDateString()})]}),t.checkOut&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Hasta:"}),e.jsx("span",{children:new Date(t.checkOut).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Hu√©spedes:"}),e.jsxs("span",{children:[t.guests.adults+t.guests.children," persona(s)"]})]})]}),e.jsxs("div",{className:"space-y-2 text-sm border-t pt-4 mt-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotal:"}),e.jsxs("span",{children:["$",t.totalPrice.toLocaleString()]})]}),s&&((v=m.find(a=>a.id===s))==null?void 0:v.processingFee)&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tarifa de procesamiento:"}),e.jsxs("span",{children:["$",(y=(f=m.find(a=>a.id===s))==null?void 0:f.processingFee)==null?void 0:y.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between font-semibold border-t pt-2",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{className:"text-green-600",children:["$",g().toLocaleString()]})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center text-blue-800",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),"Pago seguro"]}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Tus datos est√°n protegidos con encriptaci√≥n SSL de 256 bits."})]})]})})]})]}):e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})})}export{E as default};
